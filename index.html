<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"><title>ストーリービルダー</title><link rel="stylesheet" href="style.css?v=1.88"><script src="https://cdn.jsdelivr.net/npm/chart.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jsdiff/5.1.0/diff.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script><script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script><script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script><script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script></head><body><div id="login-screen" class="screen" style="justify-content:center;align-items:center;"><h1 class="app-title">ストーリービルダー</h1><button id="google-login-btn" class="btn-custom" style="padding:15px 30px;font-size:1.2em;">Googleアカウントで開始</button></div><div id="main-app" class="screen" style="display:none;"><div class="container"><div id="top-view" style="display:block;height:100%;display:flex;flex-direction:column;"><h1 class="app-title">ストーリービルダー</h1><hr><div class="dashboard-area"><div id="diary-widget" class="diary-widget"><div class="diary-title">執筆日記</div><div class="diary-content"><div class="diary-row"><span class="diary-label">今日</span><span class="diary-val" id="widget-today-count">0<span class="unit">字</span></span></div><div class="diary-row"><span class="diary-label">7日間</span><span class="diary-val" id="widget-weekly-count">0<span class="unit">字</span></span></div></div></div><div class="top-buttons"><button id="create-new-work-btn" class="btn-custom btn-full btn-brown">＋作品作成</button><button id="btn-common-memo" class="btn-custom btn-full">共通メモ</button></div></div><div class="list-header"><div class="list-title">作品リスト</div><div class="filter-group"><select id="sort-order" class="filter-select"><option value="updated">更新順</option><option value="created">作成順</option></select><select id="filter-status" class="filter-select"><option value="all">すべて</option><option value="in-progress">制作中</option><option value="completed">完了</option><option value="suspended">中断</option></select></div></div><div id="work-list" class="work-list-container"></div></div><div id="workspace-view" style="display:none;height:100%;flex-direction:column;"><button id="back-to-top" class="btn-custom btn-d-gray" style="align-self:flex-start;margin-bottom:15px;">TOPへ戻る</button><div class="tab-bar"><button class="btn-custom tab-btn active" data-tab="tab-info">作品情報</button><button class="btn-custom tab-btn" data-tab="tab-editor">執筆</button><button class="btn-custom tab-btn" data-tab="tab-plot">プロット</button><button class="btn-custom tab-btn" data-tab="tab-char">登場人物</button><button class="btn-custom tab-btn" data-tab="tab-common-memo">共通メモ</button></div><div id="tab-info" class="tab-content active" style="overflow-y:auto;padding-right:5px;"><div id="info-export-btns" style="display:flex;justify-content:flex-end;margin-bottom:10px;"><button onclick="exportData('info','txt')" class="btn-custom btn-small" style="margin-right:5px;">TXT保存</button></div><div class="form-group"><label>タイトル</label><input type="text" id="input-title" autocomplete="off"></div><div class="form-group"><label>あらすじ</label><textarea id="input-summary" rows="4" autocomplete="off"></textarea></div><div class="form-group"><label style="display:flex;justify-content:space-between;">キャッチコピー <span id="c-count" style="font-weight:bold;color:#fdd835;font-size:0.9em;">（残35）</span></label><input type="text" id="input-catch" maxlength="35" autocomplete="off"></div><div style="display:flex;gap:10px;margin-bottom:20px;"><div style="flex:1;"><label>メインジャンル</label><input type="text" id="input-genre-main" autocomplete="off"></div><div style="flex:1;"><label>サブジャンル</label><input type="text" id="input-genre-sub" autocomplete="off"></div></div><div class="form-group" id="fg-novel-length"><label>作品の長さ</label><div class="compact-row"><label><input type="radio" name="novel-length" value="long" checked><span>長編</span></label><label><input type="radio" name="novel-length" value="short"><span>短編</span></label></div></div><div class="form-group"><label>制作ステータス</label><div class="compact-row"><label><input type="radio" name="novel-status" value="in-progress" checked><span>制作中</span></label><label><input type="radio" name="novel-status" value="completed"><span>完了</span></label><label><input type="radio" name="novel-status" value="suspended"><span>中断</span></label></div></div><div class="form-group"><label>作品種別</label><div class="compact-row"><label><input type="radio" name="novel-type" value="original" checked><span>オリジナル</span></label><label><input type="radio" name="novel-type" value="derivative"><span>二次創作</span></label></div></div><div class="form-group"><label>レーティング</label><div class="compact-row"><label><input type="checkbox" name="rating" value="none"><span>なし</span></label><label><input type="checkbox" name="rating" value="sexual"><span>性描写</span></label><label><input type="checkbox" name="rating" value="violence"><span>暴力</span></label><label><input type="checkbox" name="rating" value="cruel"><span>残酷</span></label></div></div><div class="form-group"><label>AI利用について</label><div class="compact-row"><label><input type="radio" name="ai-usage" value="none" checked><span>なし</span></label><label><input type="radio" name="ai-usage" value="support"><span>補助利用</span></label><label><input type="radio" name="ai-usage" value="partial"><span>一部本文</span></label><label><input type="radio" name="ai-usage" value="full"><span>本文利用</span></label></div></div><button id="save-work-info-btn" class="btn-custom btn-full btn-d-green" style="padding:15px;margin-top:20px;font-size:16px;">作品情報を保存</button></div><div id="tab-editor" class="tab-content" style="display:none;flex:1;flex-direction:column;overflow:hidden;"></div><div id="tab-plot" class="tab-content" style="display:none;flex:1;flex-direction:column;position:relative;"><div id="plot-list-view" style="display:flex;flex-direction:column;height:100%;"><div style="display:flex;justify-content:space-between;margin-bottom:10px;"><button id="plot-add-new-btn" class="memo-add-btn btn-brown" style="width:auto;flex:1;margin-bottom:0;">＋ プロット追加</button></div><div id="plot-items-container" class="scrollable" style="flex:1;padding-bottom:20px;"></div></div><div id="plot-edit-view" class="edit-overlay" style="display:none;"><div class="edit-overlay-header"><button id="plot-edit-back" class="btn-custom btn-small btn-d-gray">戻る</button><span id="plot-header-title" style="font-weight:bold;">プロット編集</span><div id="plot-header-right"><button id="plot-txt-btn" class="btn-custom btn-small">TXT保存</button></div></div><div id="plot-view-mode" class="edit-overlay-body scrollable"></div><div id="plot-edit-mode" class="edit-overlay-body scrollable"><input type="text" id="plot-edit-title" class="form-control" placeholder="タイトル" style="margin-bottom:10px;font-weight:bold;" autocomplete="off"><div style="margin-bottom:10px;"><select id="plot-edit-type" class="filter-select" style="width:100%;"><option value="memo">メモ</option><option value="timeline">タイムライン</option></select></div><textarea id="plot-edit-content" class="main-textarea" style="flex:1;min-height:300px;" placeholder="プロット内容を入力..." autocomplete="off"></textarea><div style="margin-top:20px;display:flex;gap:10px;"><button id="plot-delete-btn" class="btn-custom btn-d-red" style="flex:0 0 auto;">削除</button><button id="plot-edit-save" class="btn-green btn-d-green" style="flex:1;">保存</button></div></div></div></div><div id="tab-char" class="tab-content" style="display:none;flex:1;flex-direction:column;position:relative;"><div id="char-list-view" style="display:flex;flex-direction:column;height:100%;"><div style="display:flex;justify-content:space-between;margin-bottom:10px;"><button id="char-add-new-btn" class="memo-add-btn btn-brown" style="width:auto;flex:1;margin-bottom:0;">＋ キャラ追加</button></div><div id="char-items-container" class="scrollable" style="flex:1;padding-bottom:20px;"></div></div><div id="char-edit-view" class="edit-overlay" style="display:none;"><div class="edit-overlay-header"><button id="char-edit-back" class="btn-custom btn-small btn-d-gray">戻る</button><span id="char-header-title" style="font-weight:bold;">キャラ情報</span><div id="char-header-right-btns" style="display:flex;gap:5px;"><button id="char-view-txt-btn" class="btn-custom btn-small">TXT保存</button><button id="char-mode-edit-btn" class="btn-custom btn-small btn-d-blue" style="display:none;">編集</button><button id="char-delete-btn" class="btn-custom btn-small btn-d-red" style="display:none;">削除</button></div></div><div id="char-view-mode" class="edit-overlay-body scrollable" style="display:none;"></div><div id="char-edit-mode" class="edit-overlay-body scrollable"><div style="display:flex;gap:15px;margin-bottom:15px;flex-wrap:wrap;"><div style="width:100px;text-align:center;"><div id="char-icon-preview" class="char-icon-large">👤</div><label class="btn-custom btn-small" style="display:block;margin-top:5px;cursor:pointer;">画像選択<input type="file" id="char-icon-input" accept="image/*" style="display:none;"></label></div><div style="flex:1;display:flex;flex-direction:column;gap:5px;min-width:200px;"><div style="display:flex;gap:5px;"><div class="char-input-group" style="flex:1;"><label>苗字</label><input type="text" id="char-name-last" class="form-control" autocomplete="off"></div><div class="char-input-group" style="flex:1;"><label>苗字ルビ</label><input type="text" id="char-ruby-last" class="form-control" autocomplete="off"></div></div><div style="display:flex;gap:5px;"><div class="char-input-group" style="flex:1;"><label>名前</label><input type="text" id="char-name-first" class="form-control" autocomplete="off"></div><div class="char-input-group" style="flex:1;"><label>名前ルビ</label><input type="text" id="char-ruby-first" class="form-control" autocomplete="off"></div></div><div class="char-input-group"><label>あだ名</label><input type="text" id="char-alias" class="form-control" autocomplete="off"></div></div></div><div class="compact-grid-form"><div class="cg-item"><label>年齢</label><div class="cg-input-wrap short-num"><input type="number" id="char-age" autocomplete="off"><span>歳</span></div></div><div class="cg-item"><label>誕生日</label><div class="cg-input-wrap birth-wrap short-num"><input type="number" id="char-birth-m" autocomplete="off"><span style="flex:0;">月</span><input type="number" id="char-birth-d" autocomplete="off"><span style="flex:0;">日</span></div></div><div class="cg-item"><label>身長</label><div class="cg-input-wrap short-num"><input type="number" id="char-height" autocomplete="off"><span>cm</span></div></div><div class="cg-item"><label>役職</label><div class="cg-input-wrap"><input type="text" id="char-role" autocomplete="off"></div></div></div><div class="form-group"><label>見た目・性格</label><textarea id="char-appearance" rows="3" class="auto-expand" autocomplete="off"></textarea></div><div class="form-group"><label>特技（能力・スキル）</label><textarea id="char-ability" rows="3" class="auto-expand" autocomplete="off"></textarea></div><div class="form-group"><label>生い立ち・背景</label><textarea id="char-background" rows="3" class="auto-expand" autocomplete="off"></textarea></div><div class="form-group"><label>その他メモ</label><textarea id="char-memo" rows="3" class="auto-expand" autocomplete="off"></textarea></div><div style="margin-top:20px;display:flex;gap:10px;"><button id="char-edit-save" class="btn-green btn-d-green" style="flex:1;">保存</button></div></div></div></div><div id="tab-common-memo" class="tab-content" style="display:none;flex:1;flex-direction:column;"><div style="display:flex;justify-content:space-between;margin-bottom:10px;"><button id="ws-add-new-memo-btn" class="memo-add-btn btn-brown" style="width:auto;flex:1;margin-bottom:0;">＋ メモ追加</button></div><div id="ws-memo-list-container" class="scrollable" style="flex:1;"></div></div></div><div id="stats-view" class="screen scrollable" style="display:none;"><button id="back-from-stats" class="btn-custom btn-d-gray" style="align-self:flex-start;margin-bottom:15px;">戻る</button><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;"><div style="font-size:20px;font-weight:bold;color:var(--text-white);">執筆文字数の推移</div><select id="stat-range" class="filter-select" style="width:100px;"><option value="7">7日間</option><option value="30">1か月</option></select></div><div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:10px;margin-bottom:20px;border:1px solid #333;min-height:200px;"><canvas id="writingChart" style="max-height:250px;width:100%;"></canvas></div><div class="stats-card-row"><div class="stats-card"><div class="label">今日の文字数</div><div class="value" id="stat-today">0<span class="unit">字</span></div></div><div class="stats-card"><div class="label">過去7日間</div><div class="value" id="stat-week">0<span class="unit">字</span></div></div></div><div class="stats-card-row"><div class="stats-card"><div class="label">総制作作品数</div><div class="value" id="stat-works">0<span class="unit">作品</span></div></div><div class="stats-card"><div class="label">総キャラクター数</div><div class="value" id="stat-chars">0<span class="unit">体</span></div></div></div></div><div id="memo-view" class="screen" style="display:none;height:100%;flex-direction:column;"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;"><button id="back-from-memo" class="btn-custom btn-d-gray" style="align-self:flex-start;">戻る</button></div><button id="add-new-memo-btn" class="memo-add-btn btn-brown">＋ 新しいメモを追加</button><div id="memo-list-container" class="scrollable" style="flex:1;"></div></div><div id="memo-editor-view" class="screen" style="display:none;height:100%;flex-direction:column;"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;"><button id="memo-editor-back-left" class="btn-custom btn-d-gray">戻る</button><div style="display:flex;gap:10px;"><button id="memo-editor-delete-right" class="btn-red btn-d-red" style="display:none;">削除</button><button id="memo-editor-export-txt" class="btn-custom">TXT保存</button><button id="memo-editor-save" class="btn-green btn-d-green">保存</button></div></div><label style="margin-bottom:5px;">タイトル</label><input type="text" id="memo-editor-title" placeholder="新規メモ" style="font-weight:bold;font-size:1.2em;margin-bottom:15px;" autocomplete="off"><label style="margin-bottom:5px;">内容</label><textarea id="memo-editor-content" class="main-textarea" style="flex:1;height:auto;" placeholder="内容を入力..." autocomplete="off"></textarea></div></div></div><div id="preview-modal" class="preview-modal" style="display:none;"><div class="preview-toolbar"><button id="preview-close-btn" class="btn-custom">閉じる</button><div style="color:#fff;font-weight:bold;">プレビュー</div><div><button id="preview-setting-btn" class="btn-custom">設定</button><button id="preview-mode-btn" class="btn-custom">縦/横</button></div></div><div id="preview-container" class="preview-container"><div id="preview-content" class="preview-content vertical-mode"></div></div></div><div id="history-modal" class="preview-modal" style="display:none;"><div class="preview-toolbar"><button id="history-close-btn" class="btn-custom">閉じる</button><div style="color:#fff;font-weight:bold;">執筆履歴・バックアップ</div><button id="history-restore-btn" class="btn-green btn-d-green">この内容で復元</button></div><div class="history-container"><div class="history-sidebar"><div class="history-list-header">保存日時 (スクロール可)</div><div id="history-list" class="history-list"></div></div><div class="history-content-area"><div id="history-diff-view" class="history-diff-view"></div></div></div></div><div id="editor-settings-modal" class="settings-modal-overlay" style="display:none;"><div class="settings-modal-card"><div class="settings-header">字間・行間の設定</div><div class="settings-desc">お好みの画面設定が可能です。</div><div class="settings-row"><label>文字の間隔</label><div class="settings-input-group"><input type="number" id="es-letter-spacing" step="0.1" value="0"><span>倍</span></div></div><div class="settings-row"><label>行の間隔</label><div class="settings-input-group"><input type="number" id="es-line-height" step="0.1" value="1.8"><span>倍</span></div></div><div class="settings-row"><label>文章の幅</label><div class="settings-input-group"><input type="number" id="es-width" value="100"><span>%</span></div></div><div class="settings-row"><label>フォントサイズ</label><div class="settings-input-group"><input type="number" id="es-font-size" value="16"><span>Pt</span></div></div><div class="settings-footer"><button id="es-cancel" class="settings-btn-cancel">キャンセル</button><button id="es-save" class="settings-btn-save">変更する</button></div></div></div><div id="preview-settings-modal" class="settings-modal-overlay" style="display:none;"><div class="settings-modal-card"><div class="settings-header">原稿の設定</div><div class="settings-desc">縦書きプレビュー設定</div><div class="settings-row-col"><label>縦の文字数</label><div class="settings-input-group-left"><input type="number" id="ps-vertical-chars" min="16" max="50" value="20"><span>字 (16~50字)</span></div></div><div class="settings-row-col"><label>1ページあたりの行数</label><div class="settings-input-group-left"><input type="number" id="ps-lines-page" min="16" max="40" value="20"><span>行 (16~40行)</span></div></div><div class="settings-row-col"><label>文字サイズの倍率</label><div class="settings-input-group-left"><input type="number" id="ps-font-scale" step="0.1" min="0.8" max="1.5" value="1"><span>倍 (0.8~1.5倍)</span></div></div><div class="settings-footer"><button id="ps-cancel" class="settings-btn-cancel">キャンセル</button><button id="ps-save" class="settings-btn-save">保存する</button></div></div></div><div id="replace-modal" class="settings-modal-overlay" style="display:none;"><div class="settings-modal-card"><div class="settings-header">置換</div><div class="settings-desc">検索する文字と置換後の文字を入力してください。</div><div class="settings-row-col"><label>検索する文字</label><input type="text" id="replace-search-input" class="form-control" style="width:100%;text-align:left;" placeholder="検索文字..."></div><div class="settings-row-col"><label>置換後の文字</label><input type="text" id="replace-target-input" class="form-control" style="width:100%;text-align:left;" placeholder="置換文字..."></div><div class="settings-footer"><button id="replace-cancel-btn" class="settings-btn-cancel">キャンセル</button><button id="replace-execute-btn" class="settings-btn-save">すべて置換</button></div></div></div><div id="ruby-modal" class="settings-modal-overlay" style="display:none;"><div class="settings-modal-card"><div class="settings-header">ルビ挿入</div><div class="settings-desc">親文字とルビを入力してください。</div><div class="settings-row-col"><label>親文字</label><input type="text" id="ruby-parent-input" class="form-control" style="width:100%;text-align:left;" placeholder="例：漢"></div><div class="settings-row-col"><label>ルビ</label><input type="text" id="ruby-text-input" class="form-control" style="width:100%;text-align:left;" placeholder="例：おとこ"></div><div class="settings-footer"><button id="ruby-cancel-btn" class="settings-btn-cancel">キャンセル</button><button id="ruby-execute-btn" class="settings-btn-save">挿入</button></div></div></div><script src="script.js?v=1.88"></script></body></html>