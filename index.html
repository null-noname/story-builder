<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
    import { getAuth } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    // Firebase Configの反映
    const firebaseConfig = {
        apiKey: "AIzaSyDc5HZ1PVW7H8-Pe8PBoY_bwCMm0jd5_PU",
        authDomain: "story-builder-app.firebaseapp.com",
        projectId: "story-builder-app",
        storageBucket: "story-builder-app.firebasestorage.app",
        messagingSenderId: "763153451684",
        appId: "1:763153451684:web:37a447d4cafb4abe41f431"
    };

    const app = initializeApp(firebaseConfig);
    window.db = getFirestore(app);
    window.auth = getAuth(app);
</script>

<div id="tab-write">
    <div class="writing-container">
        <div class="episode-sidebar">
            <div class="sidebar-header">
                <span>サブタイトル</span>
                <button class="btn-custom btn-small" onclick="addEpisode()">＋追加</button>
            </div>
            <div id="episode-list" class="episode-list"></div>
        </div>

        <div class="editor-main">
            <div class="editor-toolbar">
                <div class="tool-group">
                    <button class="btn-custom btn-small" onclick="toggleWritingMode()">縦/横切替</button>
                    <button class="btn-custom btn-small" onclick="insertRuby()">ルビ</button>
                    <button class="btn-custom btn-small" onclick="insertDash()">――</button>
                    <button class="btn-custom btn-small" onclick="replaceText()">置換</button>
                </div>
                <div class="tool-group">
                    <button class="btn-custom btn-small" onclick="editorUndo()">戻る</button>
                    <button class="btn-custom btn-small" onclick="editorRedo()">進む</button>
                    <button class="btn-custom btn-small gold-border" onclick="saveWriting()">保存</button>
                </div>
            </div>

            <input type="text" id="episode-subtitle" class="subtitle-input" placeholder="サブタイトルを入力">
            
            <div id="editor-wrapper" class="editor-wrapper horizontal">
                <textarea id="editor-textarea" class="main-textarea" oninput="updateLiveCount()" placeholder="ここから物語を始めましょう..."></textarea>
            </div>

            <div class="editor-footer">
                <span>合計: <b id="char-count-full">0</b> 字 | 空白抜き: <b id="char-count-pure">0</b></span>
            </div>
        </div>
    </div>
</div>