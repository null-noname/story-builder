<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>エディター - Story Builder</title>

    <!-- External Libraries (CDN) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="stylesheet" href="css/common/base.css">
    <link rel="stylesheet" href="css/common/components.css">
    <link rel="stylesheet" href="css/pages/dashboard.css">
    <link rel="stylesheet" href="css/stats.css">
    <link rel="stylesheet" href="css/form.css">
    <link rel="stylesheet" href="css/editor.css">
</head>

<body>
    <!-- View: Login -->
    <div id="login-screen" class="view-container">
        <div class="login-box">
            <h1 class="retro-title">エディター</h1>
            <p class="login-subtext">執筆に特化したストーリー構築ツール</p>
            <button id="google-login-btn" class="btn-retro large blue">Googleでログイン</button>
        </div>
    </div>

    <!-- Main Application Shell -->
    <div id="main-app" class="hidden">

        <!-- View: Dashboard (TOP) -->
        <div id="top-view" class="view-content view-container">
            <div class="container-narrow">
                <h1 class="retro-title">エディター</h1>

                <div class="dashboard-top-row">
                    <!-- Stats Section (Left) -->
                    <div class="stats-card click-card" onclick="switchView('stats-view')">
                        <h3>執筆日記</h3>
                        <div class="stats-row">
                            <span>今日の文字数</span>
                            <span class="bright-green-bold"><span id="stat-today-chars">0</span> <span
                                    class="stats-unit">字</span></span>
                        </div>
                        <div class="stats-row mt-10">
                            <span>7日間の文字数</span>
                            <span class="bright-green-bold"><span id="stat-weekly-chars">0</span> <span
                                    class="stats-unit">字</span></span>
                        </div>
                    </div>

                    <!-- Right Column -->
                    <div class="action-stack">
                        <!-- Create Work Section (Top Right) -->
                        <div class="action-card click-card create-card" onclick="showWorkSetup()">
                            <h3 class="text-center">＋作品作成</h3>
                        </div>
                        <!-- Common Memo Section (Bottom Right) -->
                        <button class="btn-retro large back" onclick="switchView('memo-view')">共通メモ</button>
                    </div>
                </div>

                <!-- Sort & Filter Bar -->
                <div class="filter-bar">
                    <select id="filter-status" class="select-retro">
                        <option value="all">すべて</option>
                        <option value="in-progress">制作中</option>
                        <option value="completed">制作完了</option>
                        <option value="suspended">制作中断</option>
                    </select>
                    <select id="sort-order" class="select-retro">
                        <option value="updatedAt">更新順</option>
                        <option value="createdAt">作成日</option>
                    </select>
                </div>

                <!-- Work List -->
                <div id="work-list" class="list-container">
                    <!-- Loaded via js modules -->
                </div>
            </div>
        </div>

        <!-- View: Work Setup (Information Form) - Loaded via components/setup-view.html -->
        <div id="setup-view" class="view-content view-container">
            <!-- Content injected by loader.js -->
        </div>

        <!-- View: Work Info (View Mode) - Loaded via components/info-view.html -->
        <div id="info-view" class="view-content view-container">
            <!-- Content injected by loader.js -->
        </div>

        <!-- View: Workspace (Editor) -->
        <div id="workspace-view" class="view-content">
            <div class="workspace-header">
                <div class="workspace-header-top">
                    <button class="btn-retro small back" onclick="closeWorkspace()">◀ TOPに戻る</button>
                    <div class="workspace-tabs-container">
                        <button id="tab-info" class="ws-tab" onclick="switchWorkspaceTab('info')">作品情報</button>
                        <button id="tab-editor" class="ws-tab active"
                            onclick="switchWorkspaceTab('editor')">エディター</button>
                    </div>
                </div>
            </div>

            <div class="workspace-main">
                <!-- Tab: Editor (2-Pane Layout) -->
                <div id="ws-content-editor" class="workspace-tab-content active">
                    <div class="workspace-container">
                        <!-- Left Pane: Chapter List -->
                        <div class="editor-sidebar">
                            <div class="sidebar-header">
                                <span class="gold">話一覧</span>
                                <button class="btn-icon save" onclick="addNewChapter()">＋追加</button>
                            </div>
                            <div id="chapter-list"></div>
                        </div>

                        <!-- Right Pane: Editor Content -->
                        <div class="editor-main">
                            <div class="editor-toolbar">
                                <button class="btn-icon back" onclick="toggleVerticalMode()">縦/横</button>
                                <button class="btn-icon back" onclick="insertRuby()">ルビ(R)</button>
                                <button class="btn-icon back" onclick="insertDash()">ダッシュ(D)</button>
                                <button class="btn-icon save" onclick="saveCurrentChapter()">保存</button>
                                <span id="editor-char-count">0 字</span>
                            </div>
                            <textarea id="main-editor" placeholder="物語を始めましょう..."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Tab: Work Information -->
                <div id="ws-content-info" class="workspace-tab-content">
                    <div class="container-narrow">
                        <div id="ws-info-container">
                            <!-- Setup Form will be moved here by JS when tab is active -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- View: Statistics (Full) - Loaded via components/stats.html -->
        <div id="stats-view" class="view-content view-container">
            <!-- Content injected by loader.js -->
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="js/main.js"></script>
</body>

</html>